<div class="modal-overlay" *ngIf="isOpen" (click)="onBackdropClick($event)">
  <div class="modal-container">
    <div class="modal-header">
      <h2>Reservar Mesa</h2>
      <button type="button" class="close-btn" (click)="closeModal()">×</button>
    </div>

    <div class="modal-body">
      <div class="restaurant-info" *ngIf="restaurant">
        <div class="restaurant-image">
          <img [src]="restaurant.image || '/assets/default-restaurant.jpg'" [alt]="restaurant.name">
        </div>
        <div class="restaurant-details">
          <h3>{{ restaurant.name }}</h3>
          <p class="restaurant-type">{{ restaurant.type }}</p>
          <p class="restaurant-location">{{ restaurant.location }}</p>
        </div>
      </div>

      <form [formGroup]="visitForm" (ngSubmit)="onSubmit()">
        <div class="success-message" *ngIf="successMessage">
          {{ successMessage }}
        </div>
        
        <div class="error-message" *ngIf="errorMessage">
          {{ errorMessage }}
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="fecha">Fecha</label>
            <input 
              type="date" 
              id="fecha" 
              formControlName="fecha"
              [min]="minDate"
              class="form-control">
            <div class="error" *ngIf="visitForm.get('fecha')?.invalid && visitForm.get('fecha')?.touched">
              La fecha es requerida
            </div>
          </div>

          <div class="form-group">
            <label for="hora">Hora disponible</label>
            <select id="hora" formControlName="hora" class="form-control">
              <option value="">Seleccionar hora</option>
              <option *ngFor="let hour of availableHours" [value]="hour">
                {{ hour }}
              </option>
            </select>
            <div class="error" *ngIf="visitForm.get('hora')?.invalid && visitForm.get('hora')?.touched">
              La hora es requerida
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="numeroPersonas">Número de personas</label>
          <select id="numeroPersonas" formControlName="numeroPersonas" class="form-control">
            <option [value]="1">1 persona</option>
            <option [value]="2">2 personas</option>
            <option [value]="3">3 personas</option>
            <option [value]="4">4 personas</option>
            <option [value]="5">5 personas</option>
            <option [value]="6">6 personas</option>
            <option [value]="7">7 personas</option>
            <option [value]="8">8 personas</option>
            <option [value]="9">9 personas</option>
            <option [value]="10">10 personas</option>
            <option [value]="11">11 personas</option>
            <option [value]="12">12 personas</option>
            <option [value]="15">15 personas</option>
            <option [value]="20">20 personas</option>
          </select>
          <div class="error" *ngIf="visitForm.get('numeroPersonas')?.invalid && visitForm.get('numeroPersonas')?.touched">
            El número de personas debe ser entre 1 y 20
          </div>
        </div>

        <div class="form-group">
          <label for="notasEspeciales">Notas especiales (opcional)</label>
          <textarea 
            id="notasEspeciales" 
            formControlName="notasEspeciales"
            class="form-control"
            rows="3"
            placeholder="Menciona cualquier petición especial, restricción alimentaria, celebración especial...">
          </textarea>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn-secondary" (click)="closeModal()">
            Cancelar
          </button>
          <button 
            type="submit" 
            class="btn-primary" 
            [disabled]="!visitForm.valid || isLoading">
            <span *ngIf="isLoading">Programando...</span>
            <span *ngIf="!isLoading">Programar Visita</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
